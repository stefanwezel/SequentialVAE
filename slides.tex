% !TeX program = xelatex
\documentclass[9pt]{beamer}
\usepackage{xcolor}
\definecolor{orange}{HTML}{F67941}
\definecolor{red}{HTML}{AC454A}
\definecolor{brown}{HTML}{EAD296}
\definecolor{darkgrey}{HTML}{313630}
\usefonttheme{professionalfonts} % using non standard fonts for beamer
\usefonttheme{serif} % default family is serif
\usepackage{fontspec}
\usepackage{setspace}
\usepackage{natbib}
\usepackage{animate}
\usepackage{graphicx}
%\usepackage[T1]{fontenc}

\bibliographystyle{abbrv}
%\setmainfont{Liberation Serif}
%\setmainfont{Liberation Serif}
\setmainfont{Comfortaa}
%\usepackage[T1]{fontenc}

\setbeamercolor{frametitle}{bg=orange,fg=white}
\setbeamercolor{author in head/foot}{bg=orange,fg=white}

%\setbeamerfont{page number}{size=\Huge}

%\setbeamertemplate{itemize items}[circle]
\useinnertheme{circles}
\setbeamercolor{palette primary}{bg=orange,fg=white}
%\setbeamercolor{palette secondary}{bg=red,fg=white}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\setbeamercolor{structure}{fg=red} % itemize, enumerate, etc

%\setbeamercolor{section in head/foot}{bg=red}
\setbeamercolor{title}{fg=orange} %, bg=brown
\setbeamercolor{author}{fg=darkgrey}
\setbeamercolor{institute}{fg=darkgrey}
\setbeamercolor{date}{fg=darkgrey}
%\setbeamercolor{normal text}{fg=darkgrey}
\makeatletter
\setbeamertemplate{headline}{%
	\usebeamercolor[bg]{frametitle}\rule{\textwidth}{1cm}
}
\setbeamerfont{title}{size=\LARGE}
\setbeamerfont{institute}{size=\normalsize}
\renewcommand*{\bibfont}{\scriptsize}


\setbeamertemplate{frametitle}{%
	\vskip-1cm%
	\begin{minipage}[c][\headheight][c]{\textwidth}%
		\usebeamerfont{frametitle}
		\strut\insertframetitle\par
		{%
			\ifx\insertframesubtitle\@empty%
			\else%
			{\usebeamerfont{framesubtitle}\usebeamercolor[fg]{framesubtitle}\strut\insertframesubtitle\par}%
			\fi
		}%      
		\vspace*{0.05cm}
	\end{minipage}%
	\vskip-0.1em
}
%\setbeamertemplate{footline}{%
%	\leavevmode%
%	\hbox{\begin{beamercolorbox}[wd=\paperwidth,ht=4.5ex,dp=3.125ex]{author in head/foot}%
%			\usebeamerfont{author in head/foot} bar
%	\end{beamercolorbox}}%
%	\vskip0pt%
%}
\makeatother


\title{Unsupervised Learning \\
	of Disentangled and Interpretable Representations from Sequential Data}
\author{Wei-Ning Hsu, Yu Zhang, and James Glass\\Talk by Stefan Wezel}
\institute{Explainable Machine Learning}

\date{\today}


%\setbeamertemplate{sidebar right}{}
%\setbeamertemplate{footline}{%
%	\hfill\usebeamertemplate***{navigation symbols}
%	\hspace{1cm}\insertframenumber{}}
\setbeamerfont{page number in head/foot}{size=\small}
    \setbeamertemplate{footline}{%
	\raisebox{5pt}{\makebox[\paperwidth]{\hfill\makebox[10pt]{\scriptsize\insertframenumber}}}}
\setbeamertemplate{navigation symbols}{}
%\onehalfspacing
\setstretch{1.3}
\begin{document}
	

\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\begin{frame}[plain]
	\titlepage
\end{frame} 



\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{Overview}
%\framesubtitle{}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item What are disentangled representations (intuition)
	\item Why disentangled representations
	\item Formal description of disentangled representations
	\item SequentialVAE
	\item Did they achieve disentanglement?
	\item Other approaches and challenges
\end{itemize}
\end{frame} 





\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What is disentanglement?}
\framesubtitle{Intuition}
	\begin{itemize}%\setlength\itemsep{1.5em}
	\item encode distinct generating factors in separate subsets of latent space dimensions
	\item i.e. color as one subspace, translation, as another
	\item The exact definition is often discussed, we will have a look at a proposed one
	\end{itemize}
%\animategraphics[autoplay,loop,width=\linewidth/2]{10}{disentangled_scene-}{0}{19}
\begin{figure}
\includegraphics[width=0.7\linewidth]{disentanglement_intuition.png}
\caption{adslkfjds...Source:Higgins, Irina, et al. }
\end{figure}
\end{frame} 





\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{Why learn disentangled representations?}
\framesubtitle{Motivation}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Gives us an exact idea, of what variables were used, to come to a result
	\begin{itemize}
			\item Fairness in ML (exact)
			\item Explainability/Interpretability
			\item Overall, a model just becomes more usable if latent variables carry semantic meaning		
	\end{itemize}

\end{itemize}
\end{frame} 





\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What are disentangled representations formally? }
\framesubtitle{A field-trip to group theory}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Signal can get shifted or warped
	\item the set of these transformations make up a symmetry group
	\item signal's meaning is preserved
	\item the resulting set of transformed signals are the actions of the symmetry group on the world state
\end{itemize}
\end{frame} 



\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What are disentangled representations formally? }
\framesubtitle{A field-trip to group theory}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item This symmetry group can be decomposed into symmetry subgroups
	\item One affects location
	\item the other affects frequence
\end{itemize}
\end{frame} 

\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What are disentangled representations formally? }
\framesubtitle{Disentangled Group Action}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Group action $G \times X \mapsto X$
	\item Group decomposes into direct product $G = G_{shifts} \times G_{warps}$
	\item Is disentangled with respect to decomposition of $G$
	\begin{itemize}
		\item if there is decomposition $X = X_{shifted} \times X_{warped}$
		\item and actions $G_{shifts} \times X_{shifted} \mapsto X_{shifted}$
		\item and actions $G_{warps} \times X_{warped} \mapsto X_{warped}$
	\end{itemize}
\end{itemize}
\end{frame} 

\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What are disentangled representations formally? }
\framesubtitle{Disentangled Representation}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Let $W$ be the set of world states (all shifts and warps of signal)
	\item Generative process $b:W \mapsto O$ (voice to audio processing unit)
	\item Inference process $h: O \mapsto Z$ (observation to latent space)
	\item $f:W \mapsto Z, f = h \circ b$
	\item Now, we know, there is a symmetry group acting on $W$ ($G \times W \mapsto W$)
	\item We want to find corresponding $G \times Z \mapsto Z$ to reflect symmetry structure of W in Z
	\item More formal: $g \cdot f(w) = f(g\cdot w)$
	\item This is whats called an equivariant map (famous example: convnet)
\end{itemize}
\end{frame} 



\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{What are disentangled representations formally? }
\framesubtitle{Disentangled Representation}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Assume Symmetries of $W$ decompose into direct product $G = G_1 \times ... \times G_n$
	\item Representation is disentangled if
	\begin{itemize}
		\item action $\cdot : G \times Z \mapsto Z$
		\item equivariant map $f:W \mapsto Z$ between actions on $W$ and $Z$
		\item Decomposition $Z = Z_{shifted} \times Z_{warped}$
		\item where $Z_{shifted}$ is only affected by shifts in $W$ ($G_{shifts}$)
		\item and $Z_{warped}$ is only affected by warps in $W$ ($G_{warps}$) % G acts on W this affects Z
		%\item action $\cdot$ on $Z$ is disentangled according to definition from before
	\end{itemize}
	\item There may be more criteria (preserving group structure, isomorphisms, ...) but for the intuition this is sufficient
	\item (Note that much prior knowledge about our world was injected here)
\end{itemize}
\end{frame} 




\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{Did they achieve disentanglement}
\framesubtitle{...}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item With respect to a decomposition into two
	\item Setting: 10 sentences, 630 speakers
	\item How can we formulate this in group theory?
\end{itemize}
\end{frame} 







\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{How did they do it?}
\framesubtitle{Intuition}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item With respect to a decomposition into two
	\item regularize z2 by sequence dependant prior (lookup table of s-vectors)
	\item and z1 by sequence independant prior
\end{itemize}
\end{frame} 





\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{How did they do it?}
\framesubtitle{Methods}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item Sample batch at segment level (instead of sequence level)
	\item Maximize segment variational lower bound
	\item (Force z2 to be close to mu2)
	\item approximation of mu2 is closed form equation (concave function, set derivative to 0)
\end{itemize}
\end{frame} 



\setbeamercolor{background canvas}{bg=white}
\setbeamercolor{normal text}{fg=darkgrey}
\usebeamercolor[fg]{normal text}
\setbeamertemplate{itemize item}{\color{darkgrey}$\circ$}
\begin{frame}
\frametitle{Challenges}
\framesubtitle{...}
\begin{itemize}%\setlength\itemsep{1.5em}
	\item If we really think about it, it is hard for us to define what a disentangled representation should actually be
	\item Precise biases of what the latent space should be decomposited into can be helpful as well as biases towards the 'form' of these latent subspaces
\end{itemize}
\end{frame} 

\end{document}
